/*!
 * Layzr.js 2.0.0 - A small, fast, modern, and dependency-free library for lazy loading.
 * Copyright (c) 2015 Michael Cavalea - http://callmecavs.github.io/layzr.js/
 * License: MIT
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Layzr=e()}(this,function(){"use strict";function t(t){t=t||{},this.container=document.querySelector(t.container)||window,this.selector=t.selector||"[data-layzr]",this.attr=t.attr||"data-layzr",this.retinaAttr=t.retinaAttr||"data-layzr-retina",this.bgAttr=t.bgAttr||"data-layzr-bg",this.hiddenAttr=t.hiddenAttr||"data-layzr-hidden",this.threshold=t.threshold||0,this.callback=t.callback||null,this.src=window.devicePixelRatio>1?this.retinaAttr:this.attr,this.prevLoc=0,this.ticking=!1,this.handlers=this._requestLocation.bind(this),this.elements=this._getElements(),this._create()}return t.prototype._create=function(){this.handlers(),this.container.addEventListener("scroll",this.handlers,!1),this.container.addEventListener("resize",this.handlers,!1)},t.prototype._destroy=function(){this.container.removeEventListener("scroll",this.handlers,!1),this.container.removeEventListener("resize",this.handlers,!1)},t.prototype._requestLocation=function(){this.prevLoc=this.container===window?window.pageYOffset:this.container.scrollTop+this._getOffset(this.container),this._requestTick()},t.prototype._requestTick=function(){this.ticking||(requestAnimationFrame(this._update.bind(this)),this.ticking=!0)},t.prototype._getElements=function(){var t;return t=this.container===window?document.querySelectorAll(this.selector):this.container.querySelectorAll(this.selector),Array.prototype.slice.call(t)},t.prototype._getOffset=function(t){return t.getBoundingClientRect().top+window.pageYOffset},t.prototype._inViewport=function(t){var e=this.prevLoc,i=e+this.containerHeight,r=this._getOffset(t),n=r+this.containerHeight,s=this.threshold/100*this.containerHeight;return n>=e-s&&i+s>=r},t.prototype._reveal=function(t){var e=t.getAttribute(this.src)||t.getAttribute(this.attr);t.hasAttribute(this.bgAttr)?t.style.backgroundImage='url("'+e+'")':t.setAttribute("src",e),"function"==typeof this.callback&&this.callback.call(t),t.removeAttribute(this.attr),t.removeAttribute(this.retinaAttr),t.removeAttribute(this.bgAttr),t.removeAttribute(this.hiddenAttr),this.elements=this._getElements(),0===this.elements.length&&this._destroy()},t.prototype._update=function(){this.containerHeight=this.container.innerHeight||this.container.offsetHeight,this.elements.forEach(function(t){!t.hasAttribute(this.hiddenAttr)&&this._inViewport(t)&&this._reveal(t)}.bind(this)),this.ticking=!1},t});