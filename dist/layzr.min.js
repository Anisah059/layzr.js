/*!
 * Layzr.js 2.0.0 - A small, fast, modern, and dependency-free library for lazy loading.
 * Copyright (c) 2015 Michael Cavalea - http://callmecavs.github.io/layzr.js/
 * License: MIT
 */
!function(t,e){if("function"==typeof define&&define.amd)define("Layzr",["exports","module"],e);else if("undefined"!=typeof exports&&"undefined"!=typeof module)e(exports,module);else{var n={exports:{}};e(n.exports,n),t.Layzr=n.exports}}(this,function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){var e=this,i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];n(this,t),this.selector=i.selector||"[data-layzr]",this.normalAttr=i.normalAttr||"data-layzr",this.retinaAttr=i.retinaAttr||"data-layzr-retina",this.bgAttr=i.bgAttr||"data-layzr-bg",this.threshold=i.threshold||0,this.callback=i.callback||null,this.prevLocation=0,this.ticking=!1,this.eventsBound=!1,this.eventHandler=function(){return e._requestLocation()}}return i(t,[{key:"run",value:function(){this.elements=this._getElements(),!this.eventsBound&&this._bindEvents(),this.eventHandler()}},{key:"_bindEvents",value:function(){window.addEventListener("scroll",this.eventHandler,!1),window.addEventListener("resize",this.eventHandler,!1),this.eventsBound=!0}},{key:"_unbindEvents",value:function(){window.removeEventListener("scroll",this.eventHandler,!1),window.removeEventListener("resize",this.eventHandler,!1),this.eventsBound=!1}},{key:"_requestLocation",value:function(){this.prevLocation=window.pageYOffset,this._requestTick()}},{key:"_requestTick",value:function(){var t=this;this.ticking||(requestAnimationFrame(function(){return t._update()}),this.ticking=!0)}},{key:"_getElements",value:function(){return Array.prototype.slice.call(document.querySelectorAll(this.selector))}},{key:"_getOffset",value:function(t){var e=t.getBoundingClientRect(),n=e.top+this.prevLocation;return{top:n,bottom:n+e.height}}},{key:"_inViewport",value:function(t){var e=this.threshold/100*this.windowHeight,n=this.prevLocation,i=n+this.windowHeight,r=this._getOffset(t);return r.top>=n-e&&r.bottom<=i+e}},{key:"_removeAttributes",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;e>i;i++)n[i-1]=arguments[i];n.forEach(function(e){return t.removeAttribute(e)})}},{key:"_reveal",value:function(t){var e="";t.hasAttribute(this.bgAttr)?t.style.backgroundImage='url("'+e+")":t.setAttribute("src",e),"function"==typeof this.callback&&this.callback.call(t),this._removeAttributes(t,this.normalAttr,this.retinaAttr,this.bgAttr),this.elements=this._getElements(),0===this.elements.length&&this._unbindEvents()}},{key:"_update",value:function(){var t=this;this.windowHeight=window.innerHeight,this.elements.forEach(function(e){return t._inViewport(e)&&t._reveal(e)}),this.ticking=!1}}]),t}();e.exports=r});